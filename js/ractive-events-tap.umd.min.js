!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Ractive.events.tap=n()}(this,function(){"use strict";function e(e,t){return new n(e,t)}function n(e,n){this.node=e,this.callback=n,this.preventMousedownEvents=!1,this.bind(e)}function t(e){this.__tap_handler__.mousedown(e)}function o(e){this.__tap_handler__.touchdown(e)}function i(){this.addEventListener("keydown",d,!1),this.addEventListener("blur",r,!1)}function r(){this.removeEventListener("keydown",d,!1),this.removeEventListener("blur",r,!1)}function d(e){32===e.which&&this.__tap_handler__.fire()}var s=5,v=400;return n.prototype={bind:function(e){window.navigator.pointerEnabled?e.addEventListener("pointerdown",t,!1):window.navigator.msPointerEnabled?e.addEventListener("MSPointerDown",t,!1):e.addEventListener("mousedown",t,!1),e.addEventListener("touchstart",o,!1),("BUTTON"===e.tagName||"button"===e.type)&&e.addEventListener("focus",i,!1),e.__tap_handler__=this},fire:function(e,n,t){this.callback({node:this.node,original:e,x:n,y:t})},mousedown:function(e){var n=this;if(!this.preventMousedownEvents&&(void 0===e.which||1===e.which)){var t=e.clientX,o=e.clientY,i=e.pointerId,r=function(e){e.pointerId==i&&(n.fire(e,t,o),c())},d=function(e){e.pointerId==i&&(Math.abs(e.clientX-t)>=s||Math.abs(e.clientY-o)>=s)&&c()},c=function u(){n.node.removeEventListener("MSPointerUp",r,!1),document.removeEventListener("MSPointerMove",d,!1),document.removeEventListener("MSPointerCancel",u,!1),n.node.removeEventListener("pointerup",r,!1),document.removeEventListener("pointermove",d,!1),document.removeEventListener("pointercancel",u,!1),n.node.removeEventListener("click",r,!1),document.removeEventListener("mousemove",d,!1)};window.navigator.pointerEnabled?(this.node.addEventListener("pointerup",r,!1),document.addEventListener("pointermove",d,!1),document.addEventListener("pointercancel",c,!1)):window.navigator.msPointerEnabled?(this.node.addEventListener("MSPointerUp",r,!1),document.addEventListener("MSPointerMove",d,!1),document.addEventListener("MSPointerCancel",c,!1)):(this.node.addEventListener("click",r,!1),document.addEventListener("mousemove",d,!1)),setTimeout(c,v)}},touchdown:function(){var e=this,n=event.touches[0],t=n.clientX,o=n.clientY,i=n.identifier,r=function(n){var r=n.changedTouches[0];return r.identifier!==i?void c():(n.preventDefault(),e.preventMousedownEvents=!0,clearTimeout(e.preventMousedownTimeout),e.preventMousedownTimeout=setTimeout(function(){e.preventMousedownEvents=!1},400),e.fire(n,t,o),void c())},d=function(e){(1!==e.touches.length||e.touches[0].identifier!==i)&&c();var n=e.touches[0];(Math.abs(n.clientX-t)>=s||Math.abs(n.clientY-o)>=s)&&c()},c=function u(){e.node.removeEventListener("touchend",r,!1),window.removeEventListener("touchmove",d,!1),window.removeEventListener("touchcancel",u,!1)};this.node.addEventListener("touchend",r,!1),window.addEventListener("touchmove",d,!1),window.addEventListener("touchcancel",c,!1),setTimeout(c,v)},teardown:function(){var e=this.node;e.removeEventListener("pointerdown",t,!1),e.removeEventListener("MSPointerDown",t,!1),e.removeEventListener("mousedown",t,!1),e.removeEventListener("touchstart",o,!1),e.removeEventListener("focus",i,!1)}},e});